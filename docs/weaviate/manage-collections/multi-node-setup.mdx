---
title: Multi-node setup
sidebar_position: 5
image: og/docs/howto.jpg
---

import SkipLink from "/src/components/SkipValidationLink";
import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import FilteredTextBlock from "@site/src/components/Documentation/FilteredTextBlock";
import PyCode from "!!raw-loader!/_includes/code/howto/manage-data.collections.py";
import PyCodeV3 from "!!raw-loader!/_includes/code/howto/manage-data.collections-v3.py";
import TSCode from "!!raw-loader!/_includes/code/howto/manage-data.collections.ts";
import TSCodeLegacy from "!!raw-loader!/_includes/code/howto/manage-data.collections-v2.ts";
import JavaReplicationCode from '!!raw-loader!/_includes/code/howto/java/src/test/java/io/weaviate/docs/manage-data.replication.java';
import GoCode from "!!raw-loader!/_includes/code/howto/go/docs/manage-data.classes_test.go";

## Replication settings

import RaftRFChangeWarning from "/_includes/1-25-replication-factor.mdx";

<RaftRFChangeWarning />

Configure replication settings, such as [async replication](/deploy/configuration/replication.md#async-replication-settings) and [deletion resolution strategy](../concepts/replication-architecture/consistency.md#deletion-resolution-strategies).

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# START AllReplicationSettings"
      endMarker="# END AllReplicationSettings"
      language="py"
      docRefs={[
        "weaviate.collections.classes.html#weaviate.collections.classes.config.Configure"
      ]}
    />
  </TabItem>

<TabItem value="py3" label="Python Client v3">
  <FilteredTextBlock
    text={PyCodeV3}
    startMarker="# START AllReplicationSettings"
    endMarker="# END AllReplicationSettings"
    language="pyv3"
  />
</TabItem>

<TabItem value="js" label="JS/TS Client v3">
  <FilteredTextBlock
    text={TSCode}
    startMarker="// START AllReplicationSettings"
    endMarker="// END AllReplicationSettings"
    language="ts"
  />
</TabItem>

<TabItem value="java" label="Java">
  <FilteredTextBlock
    text={JavaReplicationCode}
    startMarker="// START AllReplicationSettings"
    endMarker="// END AllReplicationSettings"
    language="java"
  />
</TabItem>

<TabItem value="go" label="Go">
  <FilteredTextBlock
    text={GoCode}
    startMarker="// START AllReplicationSettings"
    endMarker="// END AllReplicationSettings"
    language="gonew"
  />
</TabItem>

  <TabItem value="curl" label="cURL">

```bash
curl \
-X POST \
-H "Content-Type: application/json" \
-d '{
    "class": "Article",
    "properties": [
        {
            "dataType": [
                "string"
            ],
            "description": "Title of the article",
            "name": "title"
        }
    ],
    "replicationConfig": {
      "factor": 3,
      "asyncEnabled": true,
      "deletionStrategy": "TimeBasedResolution"
    }
}' \
http://localhost:8080/v1/schema
```

</TabItem>
</Tabs>

<details>
  <summary>
     Additional information
  </summary>

To use replication factors greater than one, use a [multi-node deployment](/deploy/installation-guides/docker-installation.md#multi-node-configuration).

For details on the configuration parameters, see the following:

- [Replication](/weaviate/config-refs/collections.mdx#replication)

</details>

## Sharding settings

Configure sharding per collection.

:::tip
Starting with v1.XX, you can also dynamically adjust shard counts using [cluster resharding](#cluster-resharding).
:::

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# START ShardingSettings"
      endMarker="# END ShardingSettings"
      language="py"
    />
  </TabItem>

<TabItem value="py3" label="Python Client v3">
  <FilteredTextBlock
    text={PyCodeV3}
    startMarker="# START ShardingSettings"
    endMarker="# END ShardingSettings"
    language="pyv3"
  />
</TabItem>

<TabItem value="js" label="JS/TS Client v3">
  <FilteredTextBlock
    text={TSCode}
    startMarker="// START ShardingSettings"
    endMarker="// END ShardingSettings"
    language="ts"
  />
</TabItem>

<TabItem value="js2" label="JS/TS Client v2">
  <FilteredTextBlock
    text={TSCodeLegacy}
    startMarker="// START ShardingSettings"
    endMarker="// END ShardingSettings"
    language="tsv2"
  />
</TabItem>

<TabItem value="java" label="Java">
  <FilteredTextBlock
    text={JavaReplicationCode}
    startMarker="// START ShardingSettings"
    endMarker="// END ShardingSettings"
    language="java"
  />
</TabItem>

<TabItem value="go" label="Go">
  <FilteredTextBlock
    text={GoCode}
    startMarker="// START ShardingSettings"
    endMarker="// END ShardingSettings"
    language="gonew"
  />
</TabItem>

</Tabs>

<details>
  <summary>
     Additional information
  </summary>

For details on the configuration parameters, see the following:

- [Sharding](/weaviate/config-refs/collections.mdx#sharding)

</details>

## Inspect shards (for a collection)

An index itself can be comprised of multiple shards.

import CodeSchemaShardsGet from "/_includes/code/howto/manage-data.shards.inspect.mdx";

<CodeSchemaShardsGet />

## Update shard status

You can manually update a shard to change it's status. For example, update the shard status from `READONLY` to `READY` after you make other changes.

import CodeSchemaShardsUpdate from "/_includes/code/howto/manage-data.shards.update.mdx";

<CodeSchemaShardsUpdate />

## Cluster Resharding

:::info Added in `v1.XX`
:::

Dynamically adjust the number of shards in your multi-node cluster to redistribute data for better performance and scalability.

### Before you begin

- Ensure your cluster has multiple nodes
- Plan the resharding during a maintenance window if possible
- Monitor available disk space (resharding requires temporary storage)
- Have rollback procedures ready

### Trigger resharding

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# START ClusterResharding"
      endMarker="# END ClusterResharding"
      language="py"
    />
  </TabItem>
  
  <TabItem value="js" label="JS/TS Client v3">
    ```typescript
    // [!NOTE] This code block is a placeholder and is not yet implemented.
    // Placeholder - exact syntax to be determined
    // This will be added to the TypeScript client
    await client.cluster.reshard({
      targetShards: 6,
      migrationSpeed: 'medium',
      enableValidation: true
    })
    ```
  </TabItem>
  
  <TabItem value="java" label="Java">
    ```java
    // [!NOTE] This code block is a placeholder and is not yet implemented.
    // Placeholder - exact syntax to be determined
    // This will be added to the Java client
    client.cluster().reshard()
      .withTargetShards(6)
      .withMigrationSpeed("medium")
      .withValidation(true)
      .run();
    ```
  </TabItem>
  
  <TabItem value="go" label="Go">
    ```go
    // [!NOTE] This code block is a placeholder and is not yet implemented.
    // Placeholder - exact syntax to be determined
    // This will be added to the Go client
    err := client.Cluster().Reshard().
      WithTargetShards(6).
      WithMigrationSpeed("medium").
      WithValidation(true).
      Do(context.Background())
    ```
  </TabItem>
  
  <TabItem value="curl" label="cURL">
    ```bash
    curl -X POST \
      -H "Content-Type: application/json" \
      -d '{
        "targetShards": 6,
        "migrationSpeed": "medium",
        "enableValidation": true
      }' \
      http://localhost:8080/v1/cluster/resharding
    ```
  </TabItem>
</Tabs>

### Monitor resharding progress

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    ```python
    # [!NOTE] This code block is a placeholder and is not yet implemented.
    # Placeholder - exact syntax to be determined
    status = client.cluster.get_resharding_status()
    print(f"Progress: {status.progress_percentage}%")
    print(f"Status: {status.status}")
    ```
  </TabItem>
  
  <TabItem value="curl" label="cURL">
    ```bash
    curl http://localhost:8080/v1/cluster/resharding/status
    ```
  </TabItem>
</Tabs>

### Configuration parameters

- **targetShards**: Desired number of shards after resharding
- **migrationSpeed**: Controls migration pace (`slow`, `medium`, `fast`)
- **enableValidation**: Enables real-time consistency checks (recommended)
- **batchSize**: Number of objects to migrate per batch (optional)

<details>
  <summary>Additional considerations</summary>

- **Performance impact**: Resharding may temporarily affect query performance
- **Storage requirements**: Ensure 50% additional disk space during migration
- **Monitoring**: Use the status endpoint to track progress
- **Rollback**: Contact support if rollback is needed during migration

</details>

## Further resources

- <SkipLink href="/weaviate/api/rest#tag/schema/post/schema">API References: REST: Schema</SkipLink>
- [References: Configuration: Schema](/weaviate/config-refs/collections.mdx)
- [Concepts: Data structure](../concepts/data.md)

## Questions and feedback

import DocsFeedback from "/_includes/docs-feedback.mdx";

<DocsFeedback />
